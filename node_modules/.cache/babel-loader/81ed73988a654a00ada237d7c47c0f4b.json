{"ast":null,"code":"import ChooseComponent from \"./ChooseComponent.vue\";\nimport CommentQuestionComponent from \"./CommentQuestionComponent.vue\";\nimport LatexComponent from \"../LatexComponent.vue\";\nimport ConfirmComponent from '../common/ConfirmComponent.vue';\nimport { ref } from '@vue/reactivity';\nimport { handleQuestionTest } from '../../services/question';\nexport default {\n  name: \"QuestionComponent\",\n  components: {\n    ChooseComponent,\n    LatexComponent,\n    ConfirmComponent,\n    CommentQuestionComponent\n  },\n  props: ['question', 'isUpdateEssay', 'index', 'isNormal', 'type', 'send'],\n\n  setup() {\n    const render = ref(true);\n    const confirmModal = ref(false);\n    const infoQuestion = ref([]);\n    const pressUpdate = ref(false);\n    const canEssay = ref(false);\n    const canUpdate = ref(false);\n    const handleQuestion = ref({\n      'question': {},\n      'answer': {}\n    });\n    const writeResult = ref({});\n    const result = ref(-1);\n    const essayAnswer = ref({});\n    const answerUpdate = ref(new Map());\n    const answerDelete = ref(new Set());\n    const answerCreate = ref(new Map());\n    const page = ref(1);\n    const canChoose = ref(false);\n    const answer = ref(-1);\n    const styleObject = ref({\n      \"box-shadow\": \"0 5px #666\",\n      \"transform\": \"translateY(4px)\"\n    });\n    const styleQuestion = ref(\"info-question\");\n    return {\n      render,\n      result,\n      writeResult,\n      handleQuestion,\n      essayAnswer,\n      answerUpdate,\n      answerDelete,\n      answerCreate,\n      styleQuestion,\n      confirmModal,\n      pressUpdate,\n      page,\n      styleObject,\n      infoQuestion,\n      canEssay,\n      canUpdate,\n      canChoose,\n      answer\n    };\n  },\n\n  created() {\n    // Câu hỏi thường\n    if (this.type == 0) {\n      this.canEssay = this.isUpdateEssay;\n      this.canChoose = false;\n    } // Câu hỏi thi\n\n\n    if (this.type == 1) {\n      this.canUpdate = false;\n      this.canEssay = this.isUpdateEssay;\n      this.canChoose = true;\n    } // Câu hỏi cập nhật\n\n\n    if (this.type == 2) {\n      this.canUpdate = true;\n      this.canEssay = this.isUpdateEssay;\n      this.canChoose = true;\n    } // Câu hỏi lịch sử làm bài\n\n\n    if (this.type == 3) {\n      this.canEssay = this.isUpdateEssay;\n      this.canChoose = false;\n    }\n\n    this.canEssay = this.isUpdateEssay;\n    this.infoQuestion = JSON.parse(JSON.stringify(this.question)); // if ((\"\" + this.infoQuestion.question.question_id).includes(\"new\") && this.infoQuestion.question.type != 2) {\n    //     this.answerCreate.set(this.infoQuestion.question.question_id + \"new_answer\", { 'id': this.infoQuestion.question.question_id + \"new_answer\", 'content': \"\" });\n    // }\n\n    this.handleQuestion.question = this.question.question;\n    this.page = this.question.page;\n  },\n\n  mounted() {\n    if (this.type == 3) {\n      if (this.question.question?.result_id != null) {\n        if (this.question.question.type == 2) {\n          if (this.question.question.answer != null) {\n            console.log(\"OK\");\n\n            if (this.question.question.result_id == this.question.question.answer) {\n              let choose = document.getElementById(this.question.question.question_id + '_choose_' + this.infoQuestion.question.answer);\n              choose.style.border = \"4px solid rgb(16, 249, 4)\";\n              let question = document.getElementById(\"question_\" + this.question.question.question_id);\n              question.style.border = \"4px solid rgb(16, 249, 4)\";\n            } else {\n              let chooseCorrect = document.getElementById(this.question.question.question_id + '_choose_' + this.infoQuestion.question.result_id);\n              chooseCorrect.style.border = \"4px solid rgb(16, 249, 4)\";\n              let chooseFalse = document.getElementById(this.question.question.question_id + '_choose_' + this.infoQuestion.question.answer);\n              chooseFalse.style.border = \"4px solid red\";\n              let question = document.getElementById(\"question_\" + this.question.question.question_id);\n              question.style.border = \"4px solid red\";\n            }\n          } else {\n            let chooseCorrect = document.getElementById(this.question.question.question_id + '_choose_' + this.infoQuestion.question.result_id);\n            chooseCorrect.style.border = \"4px solid rgb(16, 249, 4)\";\n          }\n        }\n\n        if (this.question.question.type == 1) {\n          if (this.question.question.contentResult == this.question.question.answer) {\n            let chooseCorrect = document.getElementById(this.question.question.question_id + '_result_' + this.infoQuestion.question.result_id);\n            chooseCorrect.style.border = \"4px solid rgb(16, 249, 4)\";\n            let chooseAnswer = document.getElementById(this.question.question.question_id + '_answer');\n            chooseAnswer.style.border = \"4px solid rgb(16, 249, 4)\";\n          } else {\n            let chooseCorrect = document.getElementById(this.question.question.question_id + '_result_' + this.infoQuestion.question.result_id);\n            chooseCorrect.style.border = \"4px solid rgb(16, 249, 4)\";\n            let chooseFalse = document.getElementById(this.question.question.question_id + '_answer');\n            chooseFalse.style.border = \"4px solid red\";\n          }\n        }\n      }\n    }\n  },\n\n  methods: {\n    back() {\n      this.pressUpdate = false;\n      this.canEssay = false;\n      this.render = false;\n      this.canChoose = false;\n      this.handleQuestion = ref({});\n      this.writeResult = ref({});\n      this.essayAnswer = ref({});\n      this.answerUpdate = ref(new Map());\n      this.answerDelete = ref(new Set());\n      this.answerCreate = ref(new Map());\n      this.answer = ref(-1);\n      this.$nextTick(() => {\n        this.render = true;\n      });\n    },\n\n    answerQuestion(answer) {\n      this.answer = answer;\n    },\n\n    publicQuestion() {},\n\n    updateQuestion() {\n      this.pressUpdate = true;\n      this.canEssay = true;\n      this.canChoose = true;\n    },\n\n    updateContentQuestion(data) {\n      // this.questionUpdate.id = this.infoQuestion.question.question_id\n      this.handleQuestion.question.content = data; // this.questionUpdate.id = this.infoQuestion.question.question_id\n    },\n\n    updateChoose(choose) {\n      if (('' + choose.id).includes('new')) {\n        choose.question_id = this.infoQuestion.question.question_id;\n        this.answerCreate.set(choose.id, choose);\n      } else {\n        choose.question_id = this.infoQuestion.question.question_id;\n        this.answerUpdate.set(choose.id, choose);\n      }\n    },\n\n    createChoose(data) {\n      data.question_id = this.infoQuestion.question.question_id;\n      this.answerCreate.set(data.id, data);\n    },\n\n    deleteAnswer(id) {\n      if (this.infoQuestion.question.type == 2) {\n        if (id == this.infoQuestion.question.result_id || this.infoQuestion.question.result_id == null) {\n          this.answer = null;\n        }\n      }\n\n      if (('' + id).includes('new')) {\n        // Xóa câu hỏi trắc nghiệm mới tạo\n        this.answerCreate.delete(id);\n      } else {\n        if (this.answerUpdate.get(id) != undefined) {\n          this.answerUpdate.delete(id);\n        }\n\n        this.answerDelete.add(id);\n      }\n    },\n\n    deleteQuestion() {\n      this.pressUpdate = false;\n      this.confirmModal = true;\n    },\n\n    confirmDelete() {\n      const idQuestion = this.question.question.question_id;\n      const deleteQuestion = {\n        'id': idQuestion,\n        'index': this.index\n      };\n\n      if (this.infoQuestion.question.type == 2) {\n        this.infoQuestion.choices.forEach(choose => {\n          this.deleteAnswer(choose.id);\n        });\n      } else {\n        this.deleteAnswer(this.infoQuestion.question.result_id);\n      }\n\n      this.$emit(\"delete\", deleteQuestion);\n      this.confirmModal = false;\n    },\n\n    async confirmUpdate() {\n      this.pressUpdate = false;\n      this.canEssay = false;\n      this.canChoose = false;\n\n      if (this.infoQuestion.question.type == 2) {\n        this.handleQuestion.question.result_id = this.answer;\n      } else {\n        this.handleQuestion.question.contentResult = this.answer;\n\n        if (Number.isInteger(this.infoQuestion.question.result_id)) {\n          let data = {\n            question_id: this.infoQuestion.question.question_id,\n            id: this.infoQuestion.question.result_id,\n            content: this.answer\n          };\n          this.answerUpdate.set(this.infoQuestion.question.result_id, data);\n        } else {\n          let data = {\n            question_id: this.infoQuestion.question.question_id,\n            id: this.infoQuestion.question.result_id,\n            content: this.answer\n          };\n          this.answerCreate.set(this.infoQuestion.question.result_id, data);\n        }\n      }\n\n      this.handleQuestion.answer.create = Array.from(this.answerCreate.values());\n      this.handleQuestion.answer.update = Array.from(this.answerUpdate.values());\n      console.log(\"Update choose\");\n      console.log(this.handleQuestion.answer.update);\n      this.handleQuestion.answer.delete = Array.from(this.answerDelete.values());\n      console.log(\"Send Data\");\n      console.log(this.handleQuestion);\n      const response = await handleQuestionTest(this.handleQuestion);\n      this.infoQuestion = response.data;\n      this.render = false;\n      this.$nextTick(() => {\n        this.render = true;\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["ChooseComponent","CommentQuestionComponent","LatexComponent","ConfirmComponent","ref","handleQuestionTest","name","components","props","setup","render","confirmModal","infoQuestion","pressUpdate","canEssay","canUpdate","handleQuestion","writeResult","result","essayAnswer","answerUpdate","Map","answerDelete","Set","answerCreate","page","canChoose","answer","styleObject","styleQuestion","created","type","isUpdateEssay","JSON","parse","stringify","question","mounted","result_id","console","log","choose","document","getElementById","question_id","style","border","chooseCorrect","chooseFalse","contentResult","chooseAnswer","methods","back","$nextTick","answerQuestion","publicQuestion","updateQuestion","updateContentQuestion","data","content","updateChoose","id","includes","set","createChoose","deleteAnswer","delete","get","undefined","add","deleteQuestion","confirmDelete","idQuestion","index","choices","forEach","$emit","confirmUpdate","Number","isInteger","create","Array","from","values","update","response"],"sourceRoot":"","sources":["G:\\Dự án Web học tập\\studyweb\\src\\components\\Question\\QuestionComponent.vue"],"sourcesContent":["<template>\r\n    <div :class=\"styleQuestion\" v-if=\"render\">\r\n        <div class=\"action-question\">\r\n            <button class=\"tool-button-test\" :style=\"pressUpdate ? styleObject : null\" @click=\"publicQuestion\"\r\n                v-if=\"canUpdate\">\r\n                Diễn đàn\r\n            </button>\r\n            <button class=\"tool-button-test\" :style=\"pressUpdate ? styleObject : null\" @click=\"updateQuestion\"\r\n                v-if=\"canUpdate\">\r\n                Sửa\r\n            </button>\r\n            <button class=\"tool-button-test\" @click=\"deleteQuestion\" v-if=\"canUpdate\">\r\n                Xóa\r\n            </button>\r\n        </div>\r\n        <h3 v-if=\"type != 0\">Câu {{ index }}: </h3>\r\n        <h3 v-if=\"type == 0\">Câu hỏi: </h3>\r\n        <LatexComponent :content=\"infoQuestion.question.content\" :isUpdate=\"pressUpdate\" @update=\"updateContentQuestion\"\r\n            :id=\"'question_' + infoQuestion.question.question_id\" />\r\n        <!-- <CommentQuestionComponent :answers=\"question.answers\" /> -->\r\n        <h3 v-if=\"(infoQuestion.question.type == 1 || infoQuestion.question.type == 3) && (type == 3 || type == 2)\">Đáp\r\n            án đúng:</h3>\r\n        <LatexComponent :isUpdate=\"canEssay\" @update=\"answerQuestion\"\r\n            :content=\"infoQuestion.question.contentResult != null ? infoQuestion.question.contentResult : ''\"\r\n            :id=\"infoQuestion.question.question_id + '_result_' + infoQuestion.question.result_id\"\r\n            v-if=\"(infoQuestion.question.type == 1 || infoQuestion.question.type == 3) && (type == 3 || type == 2)\"\r\n            class=\"border-green\" />\r\n        <h3 v-if=\"type != 2 && type != 0\">Đáp án của bạn là:</h3>\r\n        <span v-if=\"canUpdate && type != 2 && type != 0\">Bạn hãy nhập đáp án của câu hỏi</span>\r\n        <LatexComponent :isUpdate=\"!canEssay\" @update=\"answerQuestion\"\r\n            :content=\"infoQuestion.question.answer != null ? infoQuestion.question.answer : ''\"\r\n            :id=\"infoQuestion.question.question_id + '_answer'\"\r\n            v-if=\"(infoQuestion.question.type == 1 || infoQuestion.question.type == 3) && (type == 1 || type == 3)\" />\r\n        <ChooseComponent :ref=\"'chooses_' + infoQuestion.question.question_id\" :choices=\"infoQuestion.choices\"\r\n            :isUpdate=\"pressUpdate\" doTest=\"true\" @update=\"updateChoose\" @create=\"createChoose\" @delete=\"deleteAnswer\"\r\n            @chooseAnswer=\"answerQuestion\" v-if=\"(infoQuestion.question.type == 2)\" :type=\"type\"\r\n            :linkNavbar=\"'page_' + infoQuestion.question.page + '_' + index\"\r\n            :question=\"infoQuestion.question.question_id\" :canChoose=\"canChoose\" />\r\n        <!-- <LatexComponent v-if=\"(infoQuestion.question.type == 1)\" :isUpdate=\"isUpdateEssay\"\r\n            @update=\"data => updateResultEssay(infoQuestion.question.result_id, data)\" /> -->\r\n\r\n        <div class=\"action-question\" v-if=\"pressUpdate\">\r\n            <button class=\"tool-button-test\" @click=\"back\">\r\n                Trở lại\r\n            </button>\r\n            <button class=\"tool-button-test margin-bottom6px\" @click=\"confirmUpdate\">\r\n                Lưu\r\n            </button>\r\n        </div>\r\n        <ConfirmComponent v-if=\"confirmModal\" content=\"Bạn có chắc chắn muốn xóa?\" @close=\"confirmModal = false\"\r\n            @confirm=\"confirmDelete\" />\r\n        <CommentQuestionComponent v-if=\"this.infoQuestion.question.scope == 0\" />\r\n\r\n    </div>\r\n\r\n</template>\r\n<script>\r\nimport ChooseComponent from \"./ChooseComponent.vue\";\r\nimport CommentQuestionComponent from \"./CommentQuestionComponent.vue\";\r\nimport LatexComponent from \"../LatexComponent.vue\";\r\nimport ConfirmComponent from '../common/ConfirmComponent.vue'\r\nimport { ref } from '@vue/reactivity'\r\nimport { handleQuestionTest } from '../../services/question'\r\nexport default {\r\n    name: \"QuestionComponent\",\r\n    components: {\r\n        ChooseComponent,\r\n        LatexComponent,\r\n        ConfirmComponent,\r\n        CommentQuestionComponent,\r\n    },\r\n    props: ['question', 'isUpdateEssay', 'index', 'isNormal', 'type', 'send'],\r\n    setup() {\r\n        const render = ref(true)\r\n        const confirmModal = ref(false)\r\n        const infoQuestion = ref([])\r\n        const pressUpdate = ref(false)\r\n        const canEssay = ref(false)\r\n        const canUpdate = ref(false)\r\n        const handleQuestion = ref({ 'question': {}, 'answer': {} })\r\n        const writeResult = ref({})\r\n        const result = ref(-1)\r\n        const essayAnswer = ref({})\r\n        const answerUpdate = ref(new Map())\r\n        const answerDelete = ref(new Set())\r\n        const answerCreate = ref(new Map())\r\n        const page = ref(1)\r\n        const canChoose = ref(false)\r\n        const answer = ref(-1)\r\n        const styleObject = ref({\r\n            \"box-shadow\": \"0 5px #666\",\r\n            \"transform\": \"translateY(4px)\"\r\n        })\r\n        const styleQuestion = ref(\"info-question\")\r\n        return {\r\n            render, result, writeResult, handleQuestion, essayAnswer, answerUpdate, answerDelete, answerCreate, styleQuestion, confirmModal, pressUpdate, page, styleObject, infoQuestion, canEssay, canUpdate, canChoose, answer\r\n        }\r\n    },\r\n\r\n    created() {\r\n        // Câu hỏi thường\r\n        if (this.type == 0) {\r\n            this.canEssay = this.isUpdateEssay;\r\n            this.canChoose = false;\r\n\r\n        }\r\n        // Câu hỏi thi\r\n        if (this.type == 1) {\r\n            this.canUpdate = false\r\n            this.canEssay = this.isUpdateEssay\r\n            this.canChoose = true;\r\n        }\r\n        // Câu hỏi cập nhật\r\n        if (this.type == 2) {\r\n            this.canUpdate = true\r\n            this.canEssay = this.isUpdateEssay\r\n            this.canChoose = true;\r\n        }\r\n        // Câu hỏi lịch sử làm bài\r\n        if (this.type == 3) {\r\n            this.canEssay = this.isUpdateEssay\r\n            this.canChoose = false\r\n        }\r\n\r\n        this.canEssay = this.isUpdateEssay\r\n        this.infoQuestion = JSON.parse(JSON.stringify(this.question));\r\n        // if ((\"\" + this.infoQuestion.question.question_id).includes(\"new\") && this.infoQuestion.question.type != 2) {\r\n        //     this.answerCreate.set(this.infoQuestion.question.question_id + \"new_answer\", { 'id': this.infoQuestion.question.question_id + \"new_answer\", 'content': \"\" });\r\n        // }\r\n        this.handleQuestion.question = this.question.question\r\n        this.page = this.question.page\r\n    },\r\n    mounted() {\r\n        if (this.type == 3) {\r\n            if (this.question.question?.result_id != null) {\r\n                if (this.question.question.type == 2) {\r\n                    if (this.question.question.answer != null) {\r\n                        console.log(\"OK\")\r\n                        if (this.question.question.result_id == this.question.question.answer) {\r\n                            let choose = document.getElementById(this.question.question.question_id + '_choose_' + this.infoQuestion.question.answer)\r\n                            choose.style.border = \"4px solid rgb(16, 249, 4)\"\r\n                            let question = document.getElementById(\"question_\" + this.question.question.question_id)\r\n                            question.style.border = \"4px solid rgb(16, 249, 4)\"\r\n                        } else {\r\n                            let chooseCorrect = document.getElementById(this.question.question.question_id + '_choose_' + this.infoQuestion.question.result_id)\r\n                            chooseCorrect.style.border = \"4px solid rgb(16, 249, 4)\"\r\n                            let chooseFalse = document.getElementById(this.question.question.question_id + '_choose_' + this.infoQuestion.question.answer)\r\n                            chooseFalse.style.border = \"4px solid red\"\r\n\r\n                            let question = document.getElementById(\"question_\" + this.question.question.question_id)\r\n                            question.style.border = \"4px solid red\"\r\n                        }\r\n                    } else {\r\n                        let chooseCorrect = document.getElementById(this.question.question.question_id + '_choose_' + this.infoQuestion.question.result_id)\r\n                        chooseCorrect.style.border = \"4px solid rgb(16, 249, 4)\"\r\n                    }\r\n                }\r\n                if (this.question.question.type == 1) {\r\n                    if (this.question.question.contentResult == this.question.question.answer) {\r\n                        let chooseCorrect = document.getElementById(this.question.question.question_id + '_result_' + this.infoQuestion.question.result_id)\r\n                        chooseCorrect.style.border = \"4px solid rgb(16, 249, 4)\"\r\n                        let chooseAnswer = document.getElementById(this.question.question.question_id + '_answer')\r\n                        chooseAnswer.style.border = \"4px solid rgb(16, 249, 4)\"\r\n                    } else {\r\n                        let chooseCorrect = document.getElementById(this.question.question.question_id + '_result_' + this.infoQuestion.question.result_id)\r\n                        chooseCorrect.style.border = \"4px solid rgb(16, 249, 4)\"\r\n                        let chooseFalse = document.getElementById(this.question.question.question_id + '_answer')\r\n                        chooseFalse.style.border = \"4px solid red\"\r\n                    }\r\n\r\n                }\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n\r\n        back() {\r\n            this.pressUpdate = false\r\n            this.canEssay = false\r\n            this.render = false\r\n            this.canChoose = false\r\n            this.handleQuestion = ref({})\r\n            this.writeResult = ref({})\r\n            this.essayAnswer = ref({})\r\n            this.answerUpdate = ref(new Map())\r\n            this.answerDelete = ref(new Set())\r\n            this.answerCreate = ref(new Map())\r\n            this.answer = ref(-1)\r\n            this.$nextTick(() => {\r\n                this.render = true\r\n            })\r\n        },\r\n        answerQuestion(answer) {\r\n            this.answer = answer\r\n        },\r\n        publicQuestion() {\r\n\r\n        },\r\n        updateQuestion() {\r\n            this.pressUpdate = true;\r\n            this.canEssay = true;\r\n            this.canChoose = true\r\n        },\r\n        updateContentQuestion(data) {\r\n            // this.questionUpdate.id = this.infoQuestion.question.question_id\r\n            this.handleQuestion.question.content = data\r\n            // this.questionUpdate.id = this.infoQuestion.question.question_id\r\n        },\r\n        updateChoose(choose) {\r\n            if (('' + choose.id).includes('new')) {\r\n                choose.question_id = this.infoQuestion.question.question_id\r\n                this.answerCreate.set(choose.id, choose)\r\n            } else {\r\n                choose.question_id = this.infoQuestion.question.question_id\r\n                this.answerUpdate.set(choose.id, choose)\r\n            }\r\n        },\r\n\r\n        createChoose(data) {\r\n            data.question_id = this.infoQuestion.question.question_id\r\n            this.answerCreate.set(data.id, data)\r\n        },\r\n        deleteAnswer(id) {\r\n            if (this.infoQuestion.question.type == 2) {\r\n                if (id == this.infoQuestion.question.result_id || this.infoQuestion.question.result_id == null) {\r\n                    this.answer = null\r\n                }\r\n            }\r\n            if (('' + id).includes('new')) {\r\n                // Xóa câu hỏi trắc nghiệm mới tạo\r\n                this.answerCreate.delete(id)\r\n            } else {\r\n                if (this.answerUpdate.get(id) != undefined) {\r\n                    this.answerUpdate.delete(id)\r\n                }\r\n                this.answerDelete.add(id)\r\n            }\r\n\r\n        },\r\n        deleteQuestion() {\r\n            this.pressUpdate = false;\r\n            this.confirmModal = true;\r\n        },\r\n        confirmDelete() {\r\n            const idQuestion = this.question.question.question_id\r\n            const deleteQuestion = {\r\n                'id': idQuestion,\r\n                'index': this.index,\r\n            }\r\n            if (this.infoQuestion.question.type == 2) {\r\n                this.infoQuestion.choices.forEach(choose => {\r\n                    this.deleteAnswer(choose.id)\r\n                });\r\n            } else {\r\n                this.deleteAnswer(this.infoQuestion.question.result_id)\r\n\r\n            }\r\n            this.$emit(\"delete\", deleteQuestion);\r\n            this.confirmModal = false;\r\n        },\r\n        async confirmUpdate() {\r\n            this.pressUpdate = false\r\n            this.canEssay = false\r\n            this.canChoose = false\r\n            if (this.infoQuestion.question.type == 2) {\r\n                this.handleQuestion.question.result_id = this.answer\r\n            } else {\r\n                this.handleQuestion.question.contentResult = this.answer\r\n                if (Number.isInteger(this.infoQuestion.question.result_id)) {\r\n                    let data = {\r\n                        question_id: this.infoQuestion.question.question_id,\r\n                        id: this.infoQuestion.question.result_id,\r\n                        content: this.answer\r\n                    }\r\n                    this.answerUpdate.set(this.infoQuestion.question.result_id, data)\r\n                } else {\r\n                    let data = {\r\n                        question_id: this.infoQuestion.question.question_id,\r\n                        id: this.infoQuestion.question.result_id,\r\n                        content: this.answer\r\n                    }\r\n                    this.answerCreate.set(this.infoQuestion.question.result_id, data)\r\n                }\r\n            }\r\n            this.handleQuestion.answer.create = Array.from(this.answerCreate.values())\r\n            this.handleQuestion.answer.update = Array.from(this.answerUpdate.values())\r\n            console.log(\"Update choose\")\r\n            console.log(this.handleQuestion.answer.update)\r\n            this.handleQuestion.answer.delete = Array.from(this.answerDelete.values())\r\n            console.log(\"Send Data\")\r\n            console.log(this.handleQuestion)\r\n            const response = await handleQuestionTest(this.handleQuestion)\r\n            this.infoQuestion = response.data\r\n            this.render = false\r\n            this.$nextTick(() => {\r\n                this.render = true\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style>\r\n.info-question {\r\n    background-color: #222;\r\n    color: white;\r\n    margin-top: 15px;\r\n    padding: 15px;\r\n    border-style: solid;\r\n    border-color: #666363;\r\n}\r\n\r\n.info-question-correct {\r\n    background-color: #222;\r\n    color: white;\r\n    margin-top: 15px;\r\n    padding: 15px;\r\n    border-style: solid;\r\n    border-color: #666363;\r\n}\r\n\r\n.info-question-false {\r\n    background-color: #222;\r\n    color: white;\r\n    margin-top: 15px;\r\n    padding: 15px;\r\n    border-style: solid;\r\n    border-color: #666363;\r\n}\r\n\r\n.tool-button-test {\r\n    margin-left: 2px;\r\n    margin-top: 2px;\r\n    height: 35px;\r\n    box-shadow: 0 8px #999;\r\n    border-radius: 5px;\r\n    border: 2px solid #ea4f4c;\r\n    background-color: #222;\r\n    color: white;\r\n    text-align: center;\r\n    justify-content: center;\r\n    text-decoration: none;\r\n}\r\n\r\n.tool-button-test:active {\r\n\r\n    box-shadow: 0 5px #666;\r\n    transform: translateY(4px);\r\n}\r\n\r\n.margin-bottom6px {\r\n    margin-bottom: 6px;\r\n}\r\n\r\n.border-green {\r\n    border: 2px solid rgb(8, 196, 40);\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}